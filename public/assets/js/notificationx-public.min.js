!function(v){"use strict";var m={pressBarActive:0,init:function(){m.initPressBar(),m.initNotifications(),m.bindEvents()},initNotifications:function(){"undefined"!=typeof notificationx&&(window.localStorage.removeItem("nx_notifications"),0<notificationx.conversions.length&&m.processNotifications(notificationx.conversions[0]),0<notificationx.comments.length&&m.processNotifications(notificationx.comments[0]),0<notificationx.pro_ext.length&&notificationx.pro_ext.map(function(t,n){m.processNotifications(t[0])}))},bindEvents:function(){v("body").delegate(".nx-bar .nx-close","click",function(t){m.pressBarActive=0,m.hidePressBar(t.currentTarget.offsetParent.id)}),v("body").delegate(".notificationx-close","click",function(t){m.hideNotification(v(t.currentTarget.offsetParent))})},processNotifications:function(t){var o=v('<div class="notificationx-conversions"></div>'),i="";v.ajax({type:"post",url:notificationx.ajaxurl,cache:!1,data:{action:"nx_get_conversions",nonce:notificationx.nonce,ids:t},success:function(t){if(t){var n=JSON.parse(t);i=o.html(n.content),m.render_notifications(n.config,i)}}})},initPressBar:function(){var t=v(".nx-bar");0!==t.length&&t.each(function(){var s=v(this),t=s.data("press_id"),n=s.data("hide_after"),o=s.data("auto_hide"),i=s.find(".nx-countdown").data("countdown");if(void 0!==i){var e=new Date,a=e.getYear()+1900,r=e.getMonth()+1,c=parseInt(e.getDate())+parseInt(i.days),d=parseInt(e.getHours())+parseInt(i.hours),f=parseInt(e.getMinutes())+parseInt(i.minutes),l=parseInt(e.getSeconds())+parseInt(i.seconds),p=new Date(a,parseInt(r,10)-1,c,d,f,l),u="",x=i.days+", "+i.hours+", "+i.minutes+", "+i.seconds;e.setTime(e.getTime()+24*parseInt(i.days)*60*60*1e3+60*parseInt(i.hours)*60*1e3+60*parseInt(i.minutes)*1e3+1e3*parseInt(i.seconds)),Cookies.get("nx_bar_countdown_old")!==x&&(Cookies.set("nx_bar_countdown_old",x,{expires:e,path:"/"}),Cookies.clear("nx_bar_countdown")),void 0===(u=Cookies.get("nx_bar_countdown"))&&(Cookies.set("nx_bar_countdown",p.getTime(),{expires:e,path:"/"}),Cookies.set("nx_bar_countdown_old",x,{expires:e,path:"/"}),u=Cookies.get("nx_bar_countdown"));var h=setInterval(function(){var t=(new Date).getTime(),n=u-t,o=Math.floor(n/864e5),i=Math.floor(n%864e5/36e5),e=Math.floor(n%36e5/6e4),a=Math.floor(n%6e4/1e3);s.find(".nx-days").html(o),s.find(".nx-hours").html(i),s.find(".nx-minutes").html(e),s.find(".nx-seconds").html(a),n<0&&(clearInterval(h),s.find(".nx-countdown").addClass("nx-expired"))},1e3)}m.showPressBar(s,t),""===n&&void 0===n||!parseInt(o)||setTimeout(function(){m.hidePressBar("nx-bar-"+t)},1e3*parseInt(n))})},showPressBar:function(t,n){""===t&&(t=v(".nx-bar .nx-bar-"+n));var o=parseInt(t.data("initial_delay")),i=t.find(".nx-bar-inner").outerHeight(),e=0<v("#wpadminbar").length?v("#wpadminbar").outerHeight():0;(""===o||isNaN(o))&&(o=0),setTimeout(function(){v("html").addClass("nx-bar-active"),t.hasClass("nx-position-top")&&(v("html").animate({"padding-top":i+"px"},300),t.animate({top:e+"px"},300)),t.addClass("nx-bar-visible"),m.pressBarActive=1},1e3*o)},hidePressBar:function(t){var n=v(".nx-bar#"+t);v("html").removeClass("nx-bar-active"),v("html").css("padding-top","0px"),n.hasClass("nx-position-top")&&n.animate({top:0},300),n.removeClass("nx-bar-visible"),m.pressBarActive=0},render_notifications:function(n,t){var o=0,i=t.find(".notificationx-"+n.id),e=n.delay_between,a=m.lastNotification(n.id,!1);0<=a&&(o=a+1),0===n.loop&&1===i.length&&(o=0),setTimeout(function(){m.showNotification(v(i[o]),n,o),setTimeout(function(){m.hideNotification(v(i[o])),o++;var t=setInterval(function(){m.showNotification(v(i[o]),n,o),setTimeout(function(){m.hideNotification(v(i[o])),o>=i.length-1?(o=0)===n.loop&&clearInterval(t):o++},n.display_for)},e+n.display_for)},n.display_for)},n.delay_before)},showNotification:function(t,n,o){void 0!==t&&0!==t.length&&(v("body").append(t),t.animate({bottom:"30px",opacity:"1"},500),m.saveNotification(n.id,o))},hideNotification:function(t){t.animate({bottom:"-250px",opacity:"0"},1e3,function(){m.removeNotification(t)})},removeNotification:function(t){0<t.length&&t.remove()},saveNotification:function(t,n){if(window.localStorage){var o=m.lastNotification(t,!0);"object"==typeof o?o[t]=n:(o=new Object)[t]=n,window.localStorage.setItem("nx_notifications",JSON.stringify(o))}else console.log("Browser does not support localStorage!")},lastNotification:function(t,n){var o=-1;if(window.localStorage){var i=window.localStorage.getItem("nx_notifications");if(null!==i&&void 0!==(i=JSON.parse(i))[t]){if(n)return i;o=i[t]}}else console.log("Browser does not support localStorage!");return o}};jQuery(window).load(function(){m.init()})}(jQuery);