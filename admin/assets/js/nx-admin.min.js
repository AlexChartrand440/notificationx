!function(d){"use strict";d.notificationx=d.notificationx||{},d(document).ready(function(){d.notificationx.init(),d("body").on("click",".nx-metatab-menu li, .nx-builder-tab-menu li, .nx-meta-next, .nx-quick-builder-btn",function(e){e.preventDefault(),d.notificationx.tabChanger(this)}),d("body").on("click",".nx-single-theme-wrapper",function(e){e.preventDefault(),d.notificationx.templateForTheme()})}),d(window).load(function(){d(".nx-preloader").fadeOut({complete:function(){d(".nx-metatab-inner-wrapper").fadeIn()}}),d("body").on("change","#nx_meta_display_type",function(){switch(d(this).val()){case"conversions":d("#nx_meta_conversion_from").trigger("change"),d("#nx_meta_advance_edit").trigger("change");break;case"comments":d("#nx_meta_comments_source").trigger("change"),d("#nx_meta_comment_advance_edit").trigger("change");break;case"reviews":d("#nx_meta_reviews_source").trigger("change"),d("#nx_meta_wporg_advance_edit").trigger("change");break;case"download_stats":d("#nx_meta_stats_source").trigger("change"),d("#nx_meta_wpstats_advance_edit").trigger("change")}d.notificationx.templateForTheme()}),d("body").on("change","#nx_meta_wp_stats_template_new #nx_meta_wp_stats_template_new_third_param",function(){var e=d(this).val();if("tag_custom_stats"==e)return"";d("#nx_meta_wp_stats_template_new #nx_meta_wp_stats_template_new_fourth_param").val(e+"_text").trigger("change")}),d("body").on("change","#nx_meta_conversion_from",function(){var e=d(this).val();switch(d(".nx-theme .nx-single-theme-wrapper.nx-theme-selected").trigger("change"),e){case"woocommerce":d("#nx_meta_woo_template_adv").trigger("change")}}),d("body").on("change","#nx_meta_comments_source",function(){d(this).val();d(".nx-comment_themes .nx-single-theme-wrapper.nx-theme-selected").trigger("change")}),d("body").on("change","#nx_meta_reviews_source",function(){var e=d(this).val();switch(d(".nx-wporg_themes .nx-single-theme-wrapper.nx-theme-selected").trigger("change"),e){case"wp_reviews":d("#nx_meta_wp_reviews_template_adv").trigger("change")}}),d("body").on("change","#nx_meta_stats_source",function(){var e=d(this).val();switch(d(".nx-wpstats_theme .nx-single-theme-wrapper.nx-theme-selected").trigger("change"),e){case"wp_stats":d("#nx_meta_wp_stats_template_adv").trigger("change")}}),d("body").on("change",".nx-builder-content-wrapper #nx_meta_display_type.nx-select",function(e){var t=d(this).val(),n=e.currentTarget.selectedOptions[0].innerText,i=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});"conversions"===t?(d("body").on("change","#nx_meta_conversion_from.nx-select",function(e){var t=e.currentTarget.selectedOptions[0].innerText;d(".finalize_notificationx_name").text("NotificationX - "+t+" - "+i)}),d("#nx_meta_conversion_from.nx-select").trigger("change")):d(".finalize_notificationx_name").text("NotificationX - "+n+" - "+i)}),d("#nx_meta_display_type").trigger("change")}),d.notificationx.init=function(){d.notificationx.enabledDisabled(),d.notificationx.toggleFields(),d.notificationx.bindEvents(),d.notificationx.initializeFields()},d.notificationx.templateForTheme=function(){var e,t,n,i=d("#nx_meta_display_type").val();if("press_bar"!==i&&(e=d("#nx_meta_"+notificationx.source_types[i]).val(),notificationx.theme_sources.hasOwnProperty(e)&&(n="object"==typeof notificationx.theme_sources[e]?d("#nx_meta_"+notificationx.theme_sources[e][i]).val():d("#nx_meta_"+notificationx.theme_sources[e]).val()),notificationx.template_keys.hasOwnProperty(e)&&(t="object"==typeof notificationx.template_keys[e]?d("#nx_meta_"+notificationx.template_keys[e][i]):d("#nx_meta_"+notificationx.template_keys[e])),!(t.length<=0))){var a=t.attr("id");if("maps_theme"===n&&(t=d("#nx_meta_maps_theme_template_new")),0<=Object.keys(notificationx.template_settings).indexOf(a)&&0<=Object.keys(notificationx.template_settings[a]).indexOf(n)){var o=notificationx.template_settings[a][n];t.find("input, select").each(function(e,t){var n=d(t).data("subkey");0<=Object.keys(o).indexOf(n)&&("text"===t.type&&"INPUT"===t.nodeName?d(t).val(o[n]):d(t).val(o[n]).trigger("change"))})}}},d.notificationx.bindEvents=function(){d("#nx_meta_show_on").trigger("change"),d("body").on("click",".nx-single-theme-wrapper",function(){d.notificationx.selectTheme(this)}),d("body").on("click",".nx-adv-checkbox-wrap label, #nx_sound_checkbox, .nx-stats-tease",function(e){if(void 0!==d(this)[0].dataset.swal){void 0!==d(this)[0].dataset.swal&&e.preventDefault();var t=document.createElement("p"),n=document.createElement("a");n.setAttribute("href","https://notificationx.com"),n.innerText="Premium",n.style.color="red",t.innerHTML="You need to upgrade to the <strong>"+n.outerHTML+" </strong> Version to use this feature",swal({title:"Opps...",content:t,icon:"warning",buttons:[!1,"Close"],dangerMode:!0})}}),d("body").delegate(".nx-group-field .nx-group-field-title","click",function(e){e.preventDefault(),d(e.srcElement).hasClass("nx-group-field-title")&&d.notificationx.groupToggle(this)}),d("body").delegate(".nx-group-field .nx-group-clone","click",function(){d.notificationx.cloneGroup(this)}),d("body").on("click",".nx-group-field .nx-group-remove",function(){d.notificationx.removeGroup(this)}),d("body").delegate(".nx-media-field-wrapper .nx-media-upload-button","click",function(e){e.preventDefault(),d.notificationx.initMediaField(this)}),d("body").delegate(".nx-media-field-wrapper .nx-media-remove-button","click",function(e){e.preventDefault(),d.notificationx.removeMedia(this)}),d("body").delegate(".nx-settings-menu li","click",function(e){d.notificationx.settingsTab(this)}),d("body").delegate(".nx-submit-general","click",function(e){e.preventDefault();var t=d(this).parent("#nx-settings-general-form");d.notificationx.submitSettings(this,t)}),d("body").delegate(".nx-submit-cache_settings_tab","click",function(e){e.preventDefault();var t=d(this).parent("#nx-settings-cache_settings_tab-form");d.notificationx.submitSettings(this,t)}),d("body").delegate(".nx-opt-alert","click",function(e){d.notificationx.fieldAlert(this)}),d("body").delegate(".nx-section-reset","click",function(e){e.preventDefault(),d.notificationx.resetSection(this)})},d.notificationx.enabledDisabled=function(){d(".nx-admin-status label").on("click",function(e){e.stopPropagation();var t=d(this),n=t.data("post"),i=t.data("nonce"),a=t.siblings("input"),o=t.data("swal"),r=a.is(":checked");if(o){var s=document.createElement("p"),c=document.createElement("a");return c.setAttribute("href","https://wpdeveloper.net/in/notificationx-pro"),c.innerText="Premium",c.style.color="red",s.innerHTML="You need to upgrade to the <strong>"+c.outerHTML+" </strong> Version to use multiple notification for same type.",void swal({title:"Opps...",content:s,icon:"warning",buttons:[!1,"Close"],dangerMode:!0})}r?(t.siblings(".nx-admin-status-title.nxast-enable").removeClass("active"),t.siblings(".nx-admin-status-title.nxast-disable").addClass("active")):(t.siblings(".nx-admin-status-title.nxast-disable").removeClass("active"),t.siblings(".nx-admin-status-title.nxast-enable").addClass("active")),d.ajax({type:"post",url:window.ajaxurl,data:{action:"notifications_toggle_status",post_id:n,nonce:i,status:r?"inactive":"active",url:window.location.href},success:function(e){"success"!==e&&(window.location.href=window.location.href)}})})},d.notificationx.initializeFields=function(){0<d(".nx-meta-field").length&&d(".nx-meta-field").map(function(e,t){"SELECT"===t.nodeName&&d(t).select2()}),0<d(".nx-countdown-datepicker").length&&d(".nx-countdown-datepicker").each(function(){d(this).find("input").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"DD, d MM, yy"})}),d(".notificationx-metabox-wrapper .nx-meta-field:not(#nx_meta_conversion_from)").trigger("change"),0<d(".nx-colorpicker-field").length&&void 0!==d.fn.wpColorPicker&&d(".nx-colorpicker-field").each(function(){var e=d(this).val();d(this).wpColorPicker({change:function(e,t){var n=e.target,i=t.color.toString();d(n).parents(".wp-picker-container").find("input.nx-colorpicker-field").val(i).trigger("change")}}).parents(".wp-picker-container").find(".wp-color-result").css("background-color","#"+e)}),d.notificationx.groupField(),d.notificationx.template(),d(".nx-meta-template-editable").trigger("blur")},d.notificationx.groupField=function(){d(".nx-group-field-wrapper").length<0||d(".nx-group-field-wrapper").each(function(){var c=d(this),e=c.find(".nx-group-field");c.find(".nx-group-field:first"),c.find(".nx-group-field:last");e.each(function(){var e=d(this).find(".nx-group-field-title:not(.open)").next();e.is(":visible")&&e.addClass("open")}),c.find(".nx-group-field-add").on("click",function(e){e.preventDefault();var t=c.attr("id"),i=c.data("name"),n=(c.find(".nx-group-fields-wrapper"),c.find(".nx-group-field")),a=(c.find(".nx-group-field:first"),c.find(".nx-group-field:last")),o=d(c.find(".nx-group-template").html()),r=parseInt(a.data("id")),s=1;o.data("group-title");isNaN(r)||(s=r+1),n.each(function(){d(this).removeClass("open")}),o.attr("data-id",s),o.addClass("open"),o.find("tr.nx-field[id*="+t+"]").each(function(){var e=i,t=d(this).attr("id").split("[1]")[1],n=e+"["+s+"]"+t,a=d(this).find("th label");d(this).find('[name*="'+e+'[1]"]').each(function(){var e=d(this).attr("name").split("[1]"),t=e[0],n=e[1],i=t+"["+s+"]"+n;d(this).attr("id",i).attr("name",i),a.attr("for",i)}),d(this).attr("id",n)}),o.insertBefore(d(this)),d.notificationx.resetFieldIds(d(".nx-group-field"))})})},d.notificationx.tabChanger=function(e){var t,n=d(e),i=n.data("tabid"),a=n.data("tab");if(""!=a&&(t=d("#nx-"+a),d("#nx_builder_current_tab").val(a)),"BUTTON"!==e.nodeName)return n.parent().find("li").each(function(e){e<i?d(this).addClass("nx-complete"):d(this).removeClass("nx-complete")}),n.addClass("active").siblings().removeClass("active"),void t.addClass("active").siblings().removeClass("active");void 0!==t?(d('.nx-metatab-menu li[data-tabid="'+i+'"]').trigger("click"),d('.nx-builder-tab-menu li[data-tabid="'+i+'"]').trigger("click")):d("#publish").trigger("click")},d.notificationx.toggleFields=function(){d("body").delegate(".nx-meta-field","change",function(e){d.notificationx.checkDependencies(this)})},d.notificationx.toggle=function(e,t,n,i,a){var o=0;if(i=void 0===i?"":i,void 0!==e)for(;o<e.length;o++){var r=n+e[o]+i;0<=notificationx.template.indexOf(a)&&(r="#nx_meta_"+a+"_"+e[o]+i),d(r)[t]()}},d.notificationx.checkDependencies=function(e){if(null!==notificationx.toggleFields){var t=d(e),n=t.parents(".nx-field:first").data("id"),i=t.val();if("checkbox"===t.attr("type")&&(i=t.is(":checked")?1:0),t.hasClass("nx-theme-selected")){var a=t.parents(".nx-theme-control-wrapper").data("name");i=d("#"+a).val()}var o=n;if(0<=notificationx.template.indexOf(n)&&(n=t.data("subkey")),notificationx.toggleFields.hasOwnProperty(n)){var r=notificationx.toggleFields[n].hasOwnProperty(i),s=!0;if(notificationx.hideFields[n])s=notificationx.hideFields[n].hasOwnProperty(i);notificationx.toggleFields.hasOwnProperty(n)&&s&&d.each(notificationx.toggleFields[n],function(e,t){d.notificationx.toggle(t.fields,"hide","#nx-meta-","",o),d.notificationx.toggle(t.sections,"hide","#nx-meta-section-","",o)}),r&&(d.notificationx.toggle(notificationx.toggleFields[n][i].fields,"show","#nx-meta-","",o),d.notificationx.toggle(notificationx.toggleFields[n][i].sections,"show","#nx-meta-section-","",o))}if(notificationx.hideFields.hasOwnProperty(n)){var c=notificationx.hideFields[n];c.hasOwnProperty(i)&&(d.notificationx.toggle(c[i].fields,"hide","#nx-meta-","",o),d.notificationx.toggle(c[i].sections,"hide","#nx-meta-section-","",o))}}},d.notificationx.selectTheme=function(e){var t=d(e),n=t.find("img").data("theme"),i=d(t.parents(".nx-theme-control-wrapper")).data("name");t.addClass("nx-theme-selected").siblings().removeClass("nx-theme-selected"),d("#"+i).val(n),t.trigger("change")},d.notificationx.groupToggle=function(e){var t=d(e).parents(".nx-group-field");t.hasClass("open")?t.removeClass("open"):t.addClass("open").siblings().removeClass("open")},d.notificationx.removeGroup=function(e){var t=d(e).parents(".nx-group-field").attr("data-id"),n=d(e).parents('.nx-group-field[data-id="'+t+'"]'),i=n.parent();n.fadeOut({duration:300,complete:function(){d(this).remove()}}),d.notificationx.resetFieldIds(i.find(".nx-group-field"))},d.notificationx.cloneGroup=function(e){var t=d(e).parents(".nx-group-field").attr("data-id"),n=d(e).parents('.nx-group-field[data-id="'+t+'"]'),i=d(n.clone()),a=d(e).parents(".nx-group-fields-wrapper").find(".nx-group-field:last"),o=n.parent(),r=d(a).data("id")+1;n.removeClass("open"),i.attr("data-id",r),i.insertAfter(n),d.notificationx.resetFieldIds(o.find(".nx-group-field"))},d.notificationx.resetFieldIds=function(e){if(!(e.length<=0)){var l=0;e.map(function(e,t){var s=(t=d(t)).data("field-name"),c=t.find(".nx-group-field-info").data("info").group_sub_fields;t.attr("data-id",l),t.find("tr.nx-field").each(function(e,t){var n=(t=d(d(t)[0])).find('[name*="nx_meta_'+s+'"]'),i=(n.attr("data-key"),c[e].original_name),a=s+"["+l+"]["+i+"]",o="nx-meta-"+a,r="nx_meta_"+a;t.attr("data-id",a),t.attr("id",o),n.attr("id",r),n.attr("name",r),n.attr("data-key",a)}),l++})}},d.notificationx.initMediaField=function(t){var e=(t=d(t)).parents(".nx-media-field-wrapper"),n=e.find(".nx-media-remove-button"),i=e.find(".nx-thumb-container"),a=e.find(".nx-media-id"),o=e.find(".nx-media-url"),r=wp.media({title:"Upload Photo",button:{text:"Use this photo"},multiple:!1});r.on("select",function(){var e=r.state().get("selection").first().toJSON();i.addClass("nx-has-thumb").append('<img src="'+e.url+'" alt="" style="max-width:100%;"/>'),a.val(e.id),o.val(e.url),t.addClass("hidden"),n.removeClass("hidden")}),r.open()},d.notificationx.removeMedia=function(e){var t=(e=d(e)).parents(".nx-media-field-wrapper"),n=t.find(".nx-media-upload-button"),i=t.find(".nx-has-thumb"),a=t.find(".nx-media-id"),o=t.find(".nx-media-url");i.removeClass("nx-has-thumb").find("img").remove(),o.val(""),a.val(""),e.addClass("hidden"),n.removeClass("hidden")},d.notificationx.fieldAlert=function(e){var t=document.createElement("p"),n=document.createElement("a");n.setAttribute("href","https://wpdeveloper.net/in/notificationx-pro"),n.innerText="Premium",n.style.color="red",t.innerHTML="You need to upgrade to the <strong>"+n.outerHTML+" </strong> Version to use this feature",swal({title:"Opps...",content:t,icon:"warning",buttons:[!1,"Close"],dangerMode:!0})},d.notificationx.resetSection=function(e){var t=(e=d(e)).parents(".nx-meta-section").find(".nx-meta-field");(window.fieldsss=t).map(function(e,t){var n=(t=d(t)).data("default");t.val(n),t.hasClass("wp-color-picker")&&t.parents(".wp-picker-container").find(".wp-color-result").removeAttr("style"),"nx_meta_border"==t[0].id?t.trigger("click"):t.trigger("change")})},d.notificationx.settingsTab=function(e){var t=(e=d(e)).data("tab");e.addClass("active").siblings().removeClass("active"),d("#nx-"+t).addClass("active").siblings().removeClass("active")},d.notificationx.submitSettings=function(e,t){var n=(e=d(e)).data("key"),i=e.data("nonce"),a=d(t).serializeArray();d.ajax({type:"POST",url:ajaxurl,data:{action:"nx_general_settings",key:n,nonce:i,form_data:a},success:function(e){"success"===e?swal({title:"Settings Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]}):swal({title:"Settings Not Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]})}})},d.notificationx.template=function(e){d(".nx-meta-template-editable").prop("disabled",!0),d(".nx-meta-template-editable").on("blur",function(){var i,e,t=d(this),n=t[0].innerText.trim().split("\n"),a=[],o=t[0].nextElementSibling.children;null!=n&&n.forEach(function(n,e){if(""!=n){var t=n.match(/\{\{[^\s]*\}\}/g);d(o[e]).val(n),null!=t?(t.forEach(function(e,t){i=0<t?i.replace(e,'<span style="color:red">'+e+"</span>"):n.replace(e,'<span style="color:red">'+e+"</span>")}),a.push(i)):a.push(n)}}),e=a.join("<br>"),t.html(e)})}}(jQuery);