!function(d){"use strict";d.notificationx=d.notificationx||{},d(document).ready(function(){d.notificationx.init(),d("body").on("click",".nx-metatab-menu li, .nx-builder-tab-menu li, .nx-meta-next, .nx-quick-builder-btn",function(t){t.preventDefault(),d.notificationx.tabChanger(this)})}),d(window).load(function(){d("body").on("change","#nx_meta_display_type",function(){switch(d(this).val()){case"conversions":d("#nx_meta_conversion_from").trigger("change");break;case"comments":d("#nx_meta_comments_source").trigger("change");break;case"reviews":d("#nx_meta_reviews_source").trigger("change");break;case"download_stats":d("#nx_meta_stats_source").trigger("change")}}),d("body").on("change","#nx_meta_conversion_from",function(){switch(d(this).val()){case"woocommerce":d("#nx_meta_woo_template_adv").trigger("change");break;case"edd":d("#nx_meta_edd_template_adv").trigger("change")}}),d("body").on("change","#nx_meta_reviews_source",function(){switch(d(this).val()){case"wp_reviews":d("#nx_meta_wp_reviews_template_adv").trigger("change"),d("#nx_meta_wporg_advance_edit").trigger("change")}}),d("body").on("change","#nx_meta_stats_source",function(){switch(d(this).val()){case"wp_stats":d("#nx_meta_wp_stats_template_adv").trigger("change"),d("#nx_meta_wpstats_advance_edit").trigger("change")}}),d("body").on("change",".nx-builder-content-wrapper #nx_meta_display_type.nx-select",function(t){var e=d(this).val(),i=t.currentTarget.selectedOptions[0].innerText,n=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});"conversions"===e?(d("body").on("change","#nx_meta_conversion_from.nx-select",function(t){d(this).val();var e=t.currentTarget.selectedOptions[0].innerText;d(".finalize_notificationx_name").text("NotificationX - "+e+" - "+n)}),d("#nx_meta_conversion_from.nx-select").trigger("change")):d(".finalize_notificationx_name").text("NotificationX - "+i+" - "+n)}),d("#nx_meta_display_type").trigger("change")}),d.notificationx.init=function(){d.notificationx.enabledDisabled(),d.notificationx.toggleFields(),d.notificationx.bindEvents(),d.notificationx.initializeFields()},d.notificationx.bindEvents=function(){d("#nx_meta_show_on").trigger("change"),d("body").on("click",".nx-single-theme-wrapper",function(){d.notificationx.selectTheme(this)}),d("body").delegate(".nx-group-field .nx-group-field-title","click",function(t){t.preventDefault(),d(t.srcElement).hasClass("nx-group-field-title")&&d.notificationx.groupToggle(this)}),d("body").delegate(".nx-group-field .nx-group-clone","click",function(){d.notificationx.cloneGroup(this)}),d("body").on("click",".nx-group-field .nx-group-remove",function(){d.notificationx.removeGroup(this)}),d("body").delegate(".nx-media-field-wrapper .nx-media-upload-button","click",function(t){t.preventDefault(),d.notificationx.initMediaField(this)}),d("body").delegate(".nx-media-field-wrapper .nx-media-remove-button","click",function(t){t.preventDefault(),d.notificationx.removeMedia(this)}),d("body").delegate(".nx-settings-menu li","click",function(t){d.notificationx.settingsTab(this)}),d("body").delegate(".nx-submit-general","click",function(t){t.preventDefault();var e=d(this).parent("#nx-settings-general-form");d.notificationx.submitSettings(this,e)}),d("body").delegate(".nx-opt-alert","click",function(t){d.notificationx.fieldAlert(this)}),d("body").delegate(".nx-section-reset","click",function(t){t.preventDefault(),d.notificationx.resetSection(this)})},d.notificationx.enabledDisabled=function(){d(".wp-list-table .column-notification_status img").off("click").on("click",function(t){t.stopPropagation();var e=d(this),i=0<=e.attr("src").indexOf("active1.png"),n=e.data("post"),a=e.data("nonce");i?(e.attr("src",e.attr("src").replace("active1.png","active0.png")),e.attr("title","Inactive").attr("alt","Inactive")):(e.attr("src",e.attr("src").replace("active0.png","active1.png")),e.attr("title","Active").attr("alt","Active")),d.ajax({type:"post",url:window.ajaxurl,data:{action:"notifications_toggle_status",post_id:n,nonce:a,status:i?"inactive":"active"},success:function(t){"success"!==t&&(alert(t),(i=0<=e.attr("src").indexOf("active1.png"))?(e.attr("src",e.attr("src").replace("active1.png","active0.png")),e.attr("title","Inactive").attr("alt","Inactive")):(e.attr("src",e.attr("src").replace("active0.png","active1.png")),e.attr("title","Active").attr("alt","Active")))}})})},d.notificationx.initializeFields=function(){0<d(".nx-meta-field").length&&d(".nx-meta-field").map(function(t,e){"SELECT"===e.nodeName&&d(e).select2()}),0<d(".nx-countdown-datepicker").length&&d(".nx-countdown-datepicker").each(function(){d(this).find("input").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"DD, d MM, yy"})}),d(".notificationx-metabox-wrapper .nx-meta-field:not(#nx_meta_conversion_from)").trigger("change"),0<d(".nx-colorpicker-field").length&&void 0!==d.fn.wpColorPicker&&d(".nx-colorpicker-field").each(function(){var t=d(this).val();d(this).wpColorPicker({change:function(t,e){var i=t.target,n=e.color.toString();d(i).parents(".wp-picker-container").find("input.nx-colorpicker-field").val(n).trigger("change")}}).parents(".wp-picker-container").find(".wp-color-result").css("background-color","#"+t)}),d.notificationx.groupField(),d.notificationx.template(),d(".nx-meta-template-editable").trigger("blur")},d.notificationx.groupField=function(){d(".nx-group-field-wrapper").length<0||d(".nx-group-field-wrapper").each(function(){var s=d(this),t=s.find(".nx-group-field");s.find(".nx-group-field:first"),s.find(".nx-group-field:last");t.each(function(){var t=d(this).find(".nx-group-field-title:not(.open)").next();t.is(":visible")&&t.addClass("open")}),s.find(".nx-group-field-add").on("click",function(t){t.preventDefault();var e=s.attr("id"),n=s.data("name"),i=(s.find(".nx-group-fields-wrapper"),s.find(".nx-group-field")),a=(s.find(".nx-group-field:first"),s.find(".nx-group-field:last")),o=d(s.find(".nx-group-template").html()),r=parseInt(a.data("id")),c=1;o.data("group-title");isNaN(r)||(c=r+1),i.each(function(){d(this).removeClass("open")}),o.attr("data-id",c),o.addClass("open"),o.find("tr.nx-field[id*="+e+"]").each(function(){var t=n,e=d(this).attr("id").split("[1]")[1],i=t+"["+c+"]"+e,a=d(this).find("th label");d(this).find('[name*="'+t+'[1]"]').each(function(){var t=d(this).attr("name").split("[1]"),e=t[0],i=t[1],n=e+"["+c+"]"+i;d(this).attr("id",n).attr("name",n),a.attr("for",n)}),d(this).attr("id",i)}),o.insertBefore(d(this)),d.notificationx.resetFieldIds(d(".nx-group-field"))})})},d.notificationx.tabChanger=function(t){var e,i=d(t),n=i.data("tabid"),a=i.data("tab");if(""!=a&&(e=d("#nx-"+a),d("#nx_builder_current_tab").val(a)),"BUTTON"!==t.nodeName)return i.parent().find("li").each(function(t){t<n?d(this).addClass("nx-complete"):d(this).removeClass("nx-complete")}),i.addClass("active").siblings().removeClass("active"),void e.addClass("active").siblings().removeClass("active");void 0!==e?(d('.nx-metatab-menu li[data-tabid="'+n+'"]').trigger("click"),d('.nx-builder-tab-menu li[data-tabid="'+n+'"]').trigger("click")):d("#publish").trigger("click")},d.notificationx.toggleFields=function(){d("body").delegate(".nx-meta-field","change",function(t){d.notificationx.checkDependencies(this)})},d.notificationx.toggle=function(t,e,i,n,a){var o=0;if(n=void 0===n?"":n,void 0!==t)for(;o<t.length;o++){var r=i+t[o]+n;0<=notificationx.template.indexOf(a)&&(r="#nx_meta_"+a+"_"+t[o]+n),d(r)[e]()}},d.notificationx.checkDependencies=function(t){if(null!==notificationx.toggleFields){var e=d(t),i=e.parents(".nx-field:first").data("id"),n=e.val();if("checkbox"===e.attr("type")&&(n=e.is(":checked")?1:0),e.hasClass("nx-theme-selected")){var a=e.parents(".nx-theme-control-wrapper").data("name");n=d("#"+a).val()}var o=i;if(console.log(i),0<=notificationx.template.indexOf(i)&&(i=e.data("subkey")),console.log(i),notificationx.toggleFields.hasOwnProperty(i)){var r=notificationx.toggleFields[i].hasOwnProperty(n),c=!0;if(notificationx.hideFields[i])c=notificationx.hideFields[i].hasOwnProperty(n);notificationx.toggleFields.hasOwnProperty(i)&&c&&d.each(notificationx.toggleFields[i],function(t,e){d.notificationx.toggle(e.fields,"hide","#nx-meta-","",o),d.notificationx.toggle(e.sections,"hide","#nx-meta-section-","",o)}),r&&(d.notificationx.toggle(notificationx.toggleFields[i][n].fields,"show","#nx-meta-","",o),d.notificationx.toggle(notificationx.toggleFields[i][n].sections,"show","#nx-meta-section-","",o))}if(notificationx.hideFields.hasOwnProperty(i)){var s=notificationx.hideFields[i];s.hasOwnProperty(n)&&(d.notificationx.toggle(s[n].fields,"hide","#nx-meta-","",o),d.notificationx.toggle(s[n].sections,"hide","#nx-meta-section-","",o))}}},d.notificationx.selectTheme=function(t){var e=d(t),i=e.find("img").data("theme"),n=d(e.parents(".nx-theme-control-wrapper")).data("name");e.addClass("nx-theme-selected").siblings().removeClass("nx-theme-selected"),d("#"+n).val(i),e.trigger("change")},d.notificationx.groupToggle=function(t){var e=d(t).parents(".nx-group-field");e.hasClass("open")?e.removeClass("open"):e.addClass("open").siblings().removeClass("open")},d.notificationx.removeGroup=function(t){var e=d(t).parents(".nx-group-field").attr("data-id"),i=d(t).parents('.nx-group-field[data-id="'+e+'"]'),n=i.parent();i.fadeOut({duration:300,complete:function(){d(this).remove()}}),d.notificationx.resetFieldIds(n.find(".nx-group-field"))},d.notificationx.cloneGroup=function(t){var e=d(t).parents(".nx-group-field").attr("data-id"),i=d(t).parents('.nx-group-field[data-id="'+e+'"]'),n=d(i.clone()),a=d(t).parents(".nx-group-fields-wrapper").find(".nx-group-field:last"),o=i.parent(),r=d(a).data("id")+1;i.removeClass("open"),n.attr("data-id",r),n.insertAfter(i),d.notificationx.resetFieldIds(o.find(".nx-group-field"))},d.notificationx.resetFieldIds=function(t){if(!(t.length<=0)){var l=0;t.map(function(t,e){var c=(e=d(e)).data("field-name"),s=e.find(".nx-group-field-info").data("info").group_sub_fields;e.attr("data-id",l),e.find("tr.nx-field").each(function(t,e){var i=(e=d(d(e)[0])).find('[name*="nx_meta_'+c+'"]'),n=(i.attr("data-key"),s[t].original_name),a=c+"["+l+"]["+n+"]",o="nx-meta-"+a,r="nx_meta_"+a;e.attr("data-id",a),e.attr("id",o),i.attr("id",r),i.attr("name",r),i.attr("data-key",a)}),l++})}},d.notificationx.initMediaField=function(e){var t=(e=d(e)).parents(".nx-media-field-wrapper"),i=t.find(".nx-media-remove-button"),n=t.find(".nx-thumb-container"),a=t.find(".nx-media-id"),o=t.find(".nx-media-url"),r=wp.media({title:"Upload Photo",button:{text:"Use this photo"},multiple:!1});r.on("select",function(){var t=r.state().get("selection").first().toJSON();n.addClass("nx-has-thumb").append('<img src="'+t.url+'" alt="" style="max-width:100%;"/>'),a.val(t.id),o.val(t.url),e.addClass("hidden"),i.removeClass("hidden")}),r.open()},d.notificationx.removeMedia=function(t){var e=(t=d(t)).parents(".nx-media-field-wrapper"),i=e.find(".nx-media-upload-button"),n=e.find(".nx-has-thumb"),a=e.find(".nx-media-id"),o=e.find(".nx-media-url");n.removeClass("nx-has-thumb").find("img").remove(),o.val(""),a.val(""),t.addClass("hidden"),i.removeClass("hidden")},d.notificationx.fieldAlert=function(t){var e=document.createElement("p"),i=document.createElement("a");i.setAttribute("href","https://wpdeveloper.net/in/notificationx-pro"),i.innerText="Premium",i.style.color="red",e.innerHTML="You need to upgrade to the <strong>"+i.outerHTML+" </strong> Version to use this feature",swal({title:"Opps...",content:e,icon:"warning",buttons:[!1,"Close"],dangerMode:!0})},d.notificationx.resetSection=function(t){var e=(t=d(t)).parents(".nx-meta-section").find(".nx-meta-field");(window.fieldsss=e).map(function(t,e){var i=(e=d(e)).data("default");e.val(i),e.hasClass("wp-color-picker")&&e.parents(".wp-picker-container").find(".wp-color-result").removeAttr("style"),"nx_meta_border"==e[0].id?e.trigger("click"):e.trigger("change")})},d.notificationx.settingsTab=function(t){var e=(t=d(t)).data("tab");t.addClass("active").siblings().removeClass("active"),d("#nx-"+e).addClass("active").siblings().removeClass("active")},d.notificationx.submitSettings=function(t,e){var i=(t=d(t)).data("key"),n=t.data("nonce"),a=d(e).serializeArray();d.ajax({type:"POST",url:ajaxurl,data:{action:"nx_general_settings",key:i,nonce:n,form_data:a},success:function(t){"success"===t?swal({title:"Settings Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]}):swal({title:"Settings Not Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]})}})},d.notificationx.template=function(t){d(".nx-meta-template-editable").prop("disabled",!0),d(".nx-meta-template-editable").on("blur",function(){var n,t,e=d(this),i=e[0].innerText.trim().split("\n"),a=[],o=e[0].nextElementSibling.children;null!=i&&i.forEach(function(i,t){if(""!=i){var e=i.match(/\{\{[^\s]*\}\}/g);d(o[t]).val(i),null!=e&&(e.forEach(function(t,e){n=0<e?n.replace(t,'<span style="color:red">'+t+"</span>"):i.replace(t,'<span style="color:red">'+t+"</span>")}),a.push(n))}}),t=a.join("<br>"),e.html(t)})}}(jQuery);