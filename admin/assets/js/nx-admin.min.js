!function(s){"use strict";var c={init:function(){c.notificationStatus(),c.bindEvents(),c.initFields()},initFields:function(){c.initSelect2(),c.initDatepicker(),s(".notificationx-metabox-wrapper .nx-meta-field:not(#nx_meta_conversion_from)").trigger("change"),c.initColorField(),c.initGroupField()},bindEvents:function(){s("body").delegate(".nx-settings-menu li","click",function(e){c.settingsTab(this)}),s("body").delegate(".nx-submit-general","click",function(e){e.preventDefault(),c.submitSettings(this)}),s("body").delegate(".nx-opt-alert","click",function(e){c.fieldAlert(this)}),s("body").delegate(".nx-section-reset","click",function(e){e.preventDefault(),c.resetSection(this)}),s("body").delegate(".nx-meta-field","change",function(){c.fieldChange(this)}),s("body").delegate(".nx-meta-next, .nx-quick-builder-btn","click",function(e){e.preventDefault(),c.tabChanger(this)}),s("body").delegate(".nx-single-theme-wrapper","click",function(e){e.preventDefault(),c.selectImage(this)}),s("body").delegate(".nx-group-field .nx-group-field-title","click",function(e){e.preventDefault(),s(e.srcElement).hasClass("nx-group-field-title")&&c.groupToggle(this)}),s("body").delegate(".nx-group-field .nx-group-remove","click",function(){c.removeGroup(this)}),s("body").delegate(".nx-group-field .nx-group-clone","click",function(){c.cloneGroup(this)}),s("body").delegate(".nx-media-field-wrapper .nx-media-upload-button","click",function(e){e.preventDefault(),c.initMediaField(this)}),s("body").delegate(".nx-media-field-wrapper .nx-media-remove-button","click",function(e){e.preventDefault(),c.removeMedia(this)}),s("body").delegate(".nx-optin-button","click",function(e){e.preventDefault(),c.optinAllowOrNot(this)}),s("body").delegate("#nx_meta_display_type","change",function(e){e.preventDefault(),c.linkOptions(this)})},linkOptions:function(e){var t=s("#nx_meta_display_type").val();if("conversions"==t){s("#nx_meta_conversion_from").val();s("#nx_meta_notx_url").val("product_page").trigger("change")}"comments"==t&&s("#nx_meta_notx_url").val("comment_url").trigger("change")},initSelect2:function(){s(".nx-meta-field").map(function(e,t){"SELECT"===t.nodeName&&s(t).select2()})},initDatepicker:function(){s(".nx-countdown-datepicker").each(function(){s(this).find("input").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"DD, d MM, yy"})})},tabChanger:function(e){var t=(e=s(e)).parents(".nx-metatab-wrapper").data("totaltab"),n=e.data("tabid");s("#nx-"+e.data("tab"));t+1!=n?(s('.nx-metatab-menu li[data-tabid="'+n+'"]').trigger("click"),s('.nx-builder-tab-menu li[data-tabid="'+n+'"]').trigger("click")):s("#publish").trigger("click")},selectImage:function(e){var t=s(e),n=t.find("img").data("theme"),i=s(t.parents(".nx-theme-control-wrapper")).data("name");t.addClass("nx-theme-selected").siblings().removeClass("nx-theme-selected"),s("#"+i).val(n),t.trigger("change")},notificationStatus:function(){s(".wp-list-table .column-notification_status img").off("click").on("click",function(e){e.stopPropagation();var t=s(this),n=0<=s(this).attr("src").indexOf("active1.png"),i=s(this).data("post"),a=s(this).data("nonce");n?(t.attr("src",t.attr("src").replace("active1.png","active0.png")),t.attr("title","Inactive").attr("alt","Inactive")):(t.attr("src",t.attr("src").replace("active0.png","active1.png")),t.attr("title","Active").attr("alt","Active")),s.ajax({type:"post",url:ajaxurl,data:{action:"notifications_toggle_status",post_id:i,nonce:a,status:n?"inactive":"active"},success:function(e){"success"!==e&&(alert(e),(n=0<=t.attr("src").indexOf("active1.png"))?(t.attr("src",t.attr("src").replace("active1.png","active0.png")),t.attr("title","Inactive").attr("alt","Inactive")):(t.attr("src",t.attr("src").replace("active0.png","active1.png")),t.attr("title","Active").attr("alt","Active")))}})})},fieldAlert:function(e){var t=document.createElement("p"),n=document.createElement("a");n.setAttribute("href","https://wpdeveloper.net/in/notificationx-pro"),n.innerText="Premium",n.style.color="red",t.innerHTML="You need to upgrade to the <strong>"+n.outerHTML+" </strong> Version to use this feature",swal({title:"Opps...",content:t,icon:"warning",buttons:[!1,"Close"],dangerMode:!0})},resetSection:function(e){var t=(e=s(e)).parents(".nx-meta-section").find(".nx-meta-field");(window.fieldsss=t).map(function(e,t){var n=(t=s(t)).data("default");t.val(n),t.hasClass("wp-color-picker")&&t.parents(".wp-picker-container").find(".wp-color-result").removeAttr("style"),"nx_meta_border"==t[0].id?t.trigger("click"):t.trigger("change")})},fieldChange:function(e){var t=s(e),n=t.attr("id"),i=t.data("toggle"),a=t.data("hide"),o=t.val(),r=0;if("checkbox"===t.attr("type")&&(o=t.is(":checked")?1:0),t.hasClass("nx-theme-selected")&&(n=t.parents(".nx-theme-control-wrapper").data("name"),o=s("#"+n).val()),void 0!==i){for(r in"object"!=typeof i&&(i=JSON.parse(i)),i)c.fieldToggle(i[r].fields,"hide","#nx-meta-","",n),c.fieldToggle(i[r].sections,"hide","#nx-meta-section-","",n);void 0!==i[o]&&(c.fieldToggle(i[o].fields,"show","#nx-meta-","",n),c.fieldToggle(i[o].sections,"show","#nx-meta-section-","",n))}void 0!==a&&("object"!=typeof a&&(a=JSON.parse(a)),void 0!==a[o]&&(c.fieldToggle(a[o].fields,"hide","#nx-meta-","",n),c.fieldToggle(a[o].sections,"hide","#nx-meta-section-","",n)))},fieldToggle:function(e,t,n,i){var a=0;if(i=void 0===i?"":i,void 0!==e)for(;a<e.length;a++)s(n+e[a]+i)[t]()},initColorField:function(){void 0!==s.fn.wpColorPicker&&s(".nx-colorpicker-field").each(function(){var e=s(this).val();s(this).wpColorPicker({change:function(e,t){var n=e.target,i=t.color.toString();s(n).parents(".wp-picker-container").find("input.nx-colorpicker-field").val(i).trigger("change")}}).parents(".wp-picker-container").find(".wp-color-result").css("background-color","#"+e)})},initGroupField:function(){s(".nx-group-field-wrapper").length<0||s(".nx-group-field-wrapper").each(function(){var c=s(this),e=c.find(".nx-group-field");c.find(".nx-group-field:first"),c.find(".nx-group-field:last");e.each(function(){var e=s(this).find(".nx-group-field-title:not(.open)").next();e.is(":visible")&&e.addClass("open")}),c.find(".nx-group-field-add").on("click",function(e){e.preventDefault();var t=c.attr("id"),i=c.data("name"),n=(c.find(".nx-group-fields-wrapper"),c.find(".nx-group-field")),a=(c.find(".nx-group-field:first"),c.find(".nx-group-field:last")),o=s(c.find(".nx-group-template").html()),r=parseInt(a.data("id"))+1;o.data("group-title");n.each(function(){s(this).removeClass("open")}),o.attr("data-id",r),o.addClass("open"),o.find("tr.nx-field[id*="+t+"]").each(function(){var e=i,t=s(this).attr("id").split("[1]")[1],n=e+"["+r+"]"+t,a=s(this).find("th label");s(this).find('[name*="'+e+'[1]"]').each(function(){var e=s(this).attr("name").split("[1]"),t=e[0],n=e[1],i=t+"["+r+"]"+n;s(this).attr("id",i).attr("name",i),a.attr("for",i)}),s(this).attr("id",n)}),o.insertBefore(s(this))})})},setDate:function(e){var t=new Date;e.find(".nx-group-field-timestamp").val(t.getTime())},groupToggle:function(e){var t=(e=s(e)).parents(".nx-group-field");t.hasClass("open")?t.removeClass("open"):t.addClass("open").siblings().removeClass("open")},removeGroup:function(e){var t=s(e).parents(".nx-group-field").data("id");s(e).parents('.nx-group-field[data-id="'+t+'"]').fadeOut({duration:300,complete:function(){s(this).remove()}})},cloneGroup:function(e){var t=s(e).parents(".nx-group-field").data("id"),n=s(e).parents('.nx-group-field[data-id="'+t+'"]'),i=s(n.clone()),a=s(e).parents(".nx-group-fields-wrapper").find(".nx-group-field:last"),o=n.parent(),r=s(a).data("id")+1;i.attr("data-id",r),i.insertAfter(n),c.resetFieldIds(o.find(".nx-group-field"))},resetFieldIds:function(e){var a=1;e.each(function(){var e=s(this),i=e.data("field-name"),t="nx-"+i,n=e.find(".nx-group-field-info").data("info").group_sub_fields;e.data("id",a),n.forEach(function(n){e.find('tr.nx-field[id="nx-'+n.field_name+'"]').find('[name*="'+n.field_name+'"]').each(function(){var e=s(this).attr("name"),t=e.split(n.field_name)[0];void 0===t&&(t=""),e=e.replace(e,t+i+"["+a+"]["+n.original_name+"]"),s(this).attr("name",e).attr("id",e)}),e.find('tr.nx-field[id="nx-'+n.field_name+'"]').attr("id",t+"["+a+"]["+n.original_name+"]")}),a++})},initMediaField:function(t){var e=(t=s(t)).parents(".nx-media-field-wrapper"),n=e.find(".nx-media-remove-button"),i=e.find(".nx-thumb-container"),a=e.find(".nx-media-id"),o=e.find(".nx-media-url"),r=wp.media({title:"Upload Photo",button:{text:"Use this photo"},multiple:!1});r.on("select",function(){var e=r.state().get("selection").first().toJSON();i.addClass("nx-has-thumb").append('<img src="'+e.url+'" alt="" style="max-width:100%;"/>'),a.val(e.id),o.val(e.url),t.addClass("hidden"),n.removeClass("hidden")}),r.open()},removeMedia:function(e){var t=(e=s(e)).parents(".nx-media-field-wrapper"),n=t.find(".nx-media-upload-button"),i=t.find(".nx-has-thumb"),a=t.find(".nx-media-id"),o=t.find(".nx-media-url");i.removeClass("nx-has-thumb").find("img").remove(),o.val(""),a.val(""),e.addClass("hidden"),n.removeClass("hidden")},shownPreview:function(e){"press_bar"===e?s("#nx-notification-preview").hide():(s("#nx-notification-preview").removeClass("nx-notification-preview-comments").removeClass("nx-notification-preview-conversions"),s("#nx-notification-preview").show().addClass("nx-notification-preview-"+e))},updatePreview:function(e){e.map(function(c,e){var d=c.event||"change";s(c.id).each(function(){s(this).on(d,function(){var e=s(this).val(),t="",n=".notificationx-inner";if(void 0!==c.selector&&(n=c.selector),void 0!==c.unit&&(t=c.unit),"click"==d&&"border"==c.field&&(window.itemshide=c.hide,s(this).is(":checked")?c.hide.forEach(function(e){var t=s(e.key).val();s(n).css(e.property,t)}):c.hide.forEach(function(e){"border-width"==e.property?s(n).css(e.property,"0px"):s(n).css(e.property,"")})),"nx_theme"==c.field){var i=s(this).find("input"),a=i.val(),o="nx-notification-"+i.data("prev_theme"),r="nx-notification-"+a;s(n).removeClass(o),s(n).addClass(r),i.data("prev_theme",a)}void 0!==c.property&&s(n).css(c.property,e+t),"image_shape"!=c.field&&"comment_image_shape"!=c.field||s(n).removeClass("nx-img-circle nx-img-rounded nx-img-square"),"image_position"!=c.field&&"comment_image_position"!=c.field||s(n).removeClass("nx-img-left nx-img-right"),"image_shape"!=c.field&&"image_position"!=c.field&&"comment_image_shape"!=c.field&&"comment_image_position"!=c.field||(s(n).addClass("nx-img-"+e),"image_position"!=c.field&&"comment_image_position"!=c.field||("left"==e?s(".notificationx-inner").removeClass("nx-flex-reverse"):s(".notificationx-inner").addClass("nx-flex-reverse")))})})})},optinAllowOrNot:function(e){var t=(e=s(e)).data("args"),n=e.parents(".nx-opt-in"),i=n.find(".nx-single-opt input"),a={};i.each(function(){var e=s(this)[0],t=e.id;s(e).is(":checked")?a[t]=!0:a[t]=!1}),a=Object.assign(a,t),s.ajax({type:"post",url:ajaxurl,data:{action:"nx_optin_check",fields:a},success:function(e){"true"!=e&&"false"!=e||n.slideToggle("500")}})},settingsTab:function(e){var t=(e=s(e)).data("tab");e.addClass("active").siblings().removeClass("active"),s("#nx-"+t).addClass("active").siblings().removeClass("active")},submitSettings:function(e){var t=(e=s(e)).data("key"),n=e.data("nonce"),i=e.parent("#nx-settings-general-form"),a=s(i).serializeArray();s.ajax({type:"POST",url:ajaxurl,data:{action:"nx_general_settings",key:t,nonce:n,form_data:a},success:function(e){"success"===e?swal({title:"Settings Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]}):swal({title:"Settings Not Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]})}})},createTitle:function(e){s("body").on("change",e,function(e){return[s(this).val(),e.currentTarget.selectedOptions[0].innerText,(new Date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]})}};s(document).ready(function(){var n=s(".nx-metatab-menu, .nx-builder-tab-menu");n.on("click","li",function(){var e=s(this).data("tab"),t=s(this).data("tabid")-1;s("#nx_builder_current_tab").val(e),n.find("li").each(function(e){e<t?s(this).addClass("nx-complete"):s(this).removeClass("nx-complete")}),s(this).addClass("active").siblings().removeClass("active"),s("#nx-"+e).addClass("active").siblings().removeClass("active")}),c.init()}),s(window).load(function(){s("body").on("change","#nx_meta_display_type",function(){var e=s(this).val();c.shownPreview(e),"conversions"==e&&s("#nx_meta_conversion_from").trigger("change")}),s("body").on("change","#nx_meta_display_type.nx-select",function(e){var t=s(this).val(),n=e.currentTarget.selectedOptions[0].innerText,i=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});"conversions"===t?(s("body").on("change","#nx_meta_conversion_from.nx-select",function(e){s(this).val();var t=e.currentTarget.selectedOptions[0].innerText;s(".finalize_notificationx_name").text("NotificationX - "+t+" - "+i)}),s("#nx_meta_conversion_from.nx-select").trigger("change")):s(".finalize_notificationx_name").text("NotificationX - "+n+" - "+i)}),s("#nx_meta_display_type").trigger("change");c.updatePreview([{id:["#nx_meta_bg_color","#nx_meta_comment_bg_color"],field:"bg_color",property:"background-color"},{id:["#nx_meta_text_color","#nx_meta_comment_text_color"],field:"text_color",property:"color"},{id:["#nx_meta_border","#nx_meta_comment_border"],field:"border",event:"click",selector:".notificationx-inner",hide:[{key:"#nx_meta_border_size",property:"border-width"},{key:"#nx_meta_border_style",property:"border-style"},{key:"#nx_meta_border_color",property:"border-color"},{key:"#nx_meta_comment_border_size",property:"border-width"},{key:"#nx_meta_comment_border_style",property:"border-style"},{key:"#nx_meta_comment_border_color",property:"border-color"}]},{id:["#nx_meta_border_size","#nx_meta_comment_border_size"],field:"border_size",event:"keyup",property:"border-width",selector:".notificationx-inner",unit:"px"},{id:["#nx_meta_border_style","#nx_meta_comment_border_style"],field:"border_style",property:"border-style",selector:".notificationx-inner"},{id:["#nx_meta_border_color","#nx_meta_comment_border_color"],field:"border_color",property:"border-color",selector:".notificationx-inner"},{id:["#nx_meta_image_shape","#nx_meta_comment_image_shape"],field:"image_shape",selector:".nx-preview-image > img"},{id:["#nx_meta_image_position","#nx_meta_comment_image_position"],field:"image_position",selector:".notificationx-inner"},{id:["#nx_meta_first_font_size","#nx_meta_comment_first_font_size"],field:"first_font_size",selector:".nx-first-row",property:"font-size",event:"keyup",unit:"px"},{id:["#nx_meta_second_font_size","#nx_meta_comment_second_font_size"],field:"second_font_size",selector:".nx-second-row",property:"font-size",event:"keyup",unit:"px"},{id:["#nx_meta_third_font_size","#nx_meta_comment_third_font_size"],field:"third_font_size",selector:".nx-third-row",property:"font-size",event:"keyup",unit:"px"},{id:["#nx-meta-theme","#nx-meta-comment_theme"],field:"nx_theme",event:"change",selector:".notificationx-inner"}]);var d=[{id:["#nx_meta_image_shape","#nx_meta_bg_color","#nx_meta_text_color","#nx_meta_image_position"],event:"change",type:"conversions"},{id:["#nx_meta_border_color","#nx_meta_border_style"],event:"change",type:"conversions",dependency:"#nx_meta_border"},{id:["#nx_meta_border_size"],event:"keyup",type:"conversions",dependency:"#nx_meta_border"},{id:["#nx_meta_first_font_size","#nx_meta_second_font_size","#nx_meta_third_font_size"],event:"keyup",type:"conversions"},{id:["#nx_meta_comment_image_shape","#nx_meta_comment_bg_color","#nx_meta_comment_text_color","#nx_meta_comment_image_position"],event:"change",type:"comments"},{id:["#nx_meta_comment_border_color","#nx_meta_comment_border_style"],event:"change",type:"comments",dependency:"#nx_meta_comment_border"},{id:["#nx_meta_comment_border_size"],event:"keyup",type:"comments",dependency:"#nx_meta_comment_border"},{id:["#nx_meta_comment_first_font_size","#nx_meta_comment_second_font_size","#nx_meta_comment_third_font_size"],event:"keyup",type:"comments"}];s(".nx-meta-adv_checkbox").each(function(){var c=s(this);c.on("click","label",function(e){var t,n,i=d.length;if(s(c).find("input").is(":checked"))return s(".notificationx-inner").removeAttr("style"),s(".notificationx-inner").removeClass("nx-img-left nx-img-right nx-flex-reverse"),void s(".notificationx-image > img").removeClass();for(t=0;t<i;t++){var a=d[t],o=a.id.length;for(n=0;n<o;n++){var r=s(a.id[n]);if(s("#nx_meta_display_type").val()===a.type){if(void 0!==a.dependency){if(0<s(a.dependency+":checked").length)return void s(r).trigger(a.event);continue}s(r).trigger(a.event)}}}})})})}(jQuery);