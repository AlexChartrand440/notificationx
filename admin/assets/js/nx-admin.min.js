!function(c){"use strict";var d={init:function(){d.notificationStatus(),d.bindEvents(),d.initFields()},initFields:function(){d.initSelect2(),c(".notificationx-metabox-wrapper .nx-meta-field:not(#nx_meta_conversion_from)").trigger("change"),d.initColorField(),d.initGroupField()},bindEvents:function(){c("body").delegate(".nx-settings-menu li","click",function(e){d.settingsTab(this)}),c("body").delegate(".nx-submit-general","click",function(e){e.preventDefault(),d.submitSettings(this)}),c("body").delegate(".nx-opt-alert","click",function(e){d.fieldAlert(this)}),c("body").delegate(".nx-section-reset","click",function(e){e.preventDefault(),d.resetSection(this)}),c("body").delegate(".nx-meta-field","change",function(){d.fieldChange(this)}),c("body").delegate(".nx-meta-next, .nx-quick-builder-btn","click",function(e){e.preventDefault(),d.tabChanger(this)}),c("body").delegate(".nx-single-theme-wrapper","click",function(e){e.preventDefault(),d.selectImage(this)}),c("body").delegate(".nx-group-field .nx-group-field-title","click",function(e){e.preventDefault(),c(e.srcElement).hasClass("nx-group-field-title")&&d.groupToggle(this)}),c("body").delegate(".nx-group-field .nx-group-remove","click",function(){d.removeGroup(this)}),c("body").delegate(".nx-group-field .nx-group-clone","click",function(){d.cloneGroup(this)}),c("body").delegate(".nx-media-field-wrapper .nx-media-upload-button","click",function(e){e.preventDefault(),d.initMediaField(this)}),c("body").delegate(".nx-media-field-wrapper .nx-media-remove-button","click",function(e){e.preventDefault(),d.removeMedia(this)}),c("body").delegate(".nx-optin-button","click",function(e){e.preventDefault(),d.optinAllowOrNot(this)})},initSelect2:function(){c(".nx-meta-field").map(function(e,t){"SELECT"===t.nodeName&&c(t).select2()})},tabChanger:function(e){var t=(e=c(e)).parents(".nx-metatab-wrapper").data("totaltab"),n=e.data("tabid");c("#nx-"+e.data("tab"));t+1!=n?(c('.nx-metatab-menu li[data-tabid="'+n+'"]').trigger("click"),c('.nx-builder-tab-menu li[data-tabid="'+n+'"]').trigger("click")):c("#publish").trigger("click")},selectImage:function(e){var t=c(e),n=t.find("img").data("theme"),i=c(t.parents(".nx-theme-control-wrapper")).data("name");t.addClass("nx-theme-selected").siblings().removeClass("nx-theme-selected"),c("#"+i).val(n),t.trigger("change")},notificationStatus:function(){c(".wp-list-table .column-notification_status img").off("click").on("click",function(e){e.stopPropagation();var t=c(this),n=0<=c(this).attr("src").indexOf("active1.png"),i=c(this).data("post"),a=c(this).data("nonce");n?(t.attr("src",t.attr("src").replace("active1.png","active0.png")),t.attr("title","Inactive").attr("alt","Inactive")):(t.attr("src",t.attr("src").replace("active0.png","active1.png")),t.attr("title","Active").attr("alt","Active")),c.ajax({type:"post",url:ajaxurl,data:{action:"notifications_toggle_status",post_id:i,nonce:a,status:n?"inactive":"active"},success:function(e){"success"!==e&&(alert(e),(n=0<=t.attr("src").indexOf("active1.png"))?(t.attr("src",t.attr("src").replace("active1.png","active0.png")),t.attr("title","Inactive").attr("alt","Inactive")):(t.attr("src",t.attr("src").replace("active0.png","active1.png")),t.attr("title","Active").attr("alt","Active")))}})})},fieldAlert:function(e){var t=document.createElement("p"),n=document.createElement("a");n.setAttribute("href","https://wpdeveloper.net/in/notificationx-pro"),n.innerText="Premium",n.style.color="red",t.innerHTML="You need to upgrade to the <strong>"+n.outerHTML+" </strong> Version to use this feature",swal({title:"Opps...",content:t,icon:"warning",buttons:[!1,"Close"],dangerMode:!0})},resetSection:function(e){var t=(e=c(e)).parents(".nx-meta-section").find(".nx-meta-field");(window.fieldsss=t).map(function(e,t){var n=(t=c(t)).data("default");t.val(n),t.hasClass("wp-color-picker")&&t.parents(".wp-picker-container").find(".wp-color-result").removeAttr("style"),"nx_meta_border"==t[0].id?t.trigger("click"):t.trigger("change")})},fieldChange:function(e){var t=c(e),n=t.attr("id"),i=t.data("toggle"),a=t.data("hide"),o=t.val(),r=0;if("checkbox"===t.attr("type")&&(o=t.is(":checked")?1:0),t.hasClass("nx-theme-selected")&&(n=t.parents(".nx-theme-control-wrapper").data("name"),o=c("#"+n).val()),void 0!==i){for(r in"object"!=typeof i&&(i=JSON.parse(i)),i)d.fieldToggle(i[r].fields,"hide","#nx-meta-","",n),d.fieldToggle(i[r].sections,"hide","#nx-meta-section-","",n);void 0!==i[o]&&(d.fieldToggle(i[o].fields,"show","#nx-meta-","",n),d.fieldToggle(i[o].sections,"show","#nx-meta-section-","",n))}void 0!==a&&("object"!=typeof a&&(a=JSON.parse(a)),void 0!==a[o]&&(d.fieldToggle(a[o].fields,"hide","#nx-meta-","",n),d.fieldToggle(a[o].sections,"hide","#nx-meta-section-","",n)))},fieldToggle:function(e,t,n,i){var a=0;if(i=void 0===i?"":i,void 0!==e)for(;a<e.length;a++)c(n+e[a]+i)[t]()},initColorField:function(){void 0!==c.fn.wpColorPicker&&c(".nx-colorpicker-field").each(function(){var e=c(this).val();c(this).wpColorPicker({change:function(e,t){var n=e.target,i=t.color.toString();c(n).parents(".wp-picker-container").find("input.nx-colorpicker-field").val(i).trigger("change")}}).parents(".wp-picker-container").find(".wp-color-result").css("background-color","#"+e)})},initGroupField:function(){c(".nx-group-field-wrapper").length<0||c(".nx-group-field-wrapper").each(function(){var d=c(this),e=d.find(".nx-group-field");d.find(".nx-group-field:first"),d.find(".nx-group-field:last");e.each(function(){var e=c(this).find(".nx-group-field-title:not(.open)").next();e.is(":visible")&&e.addClass("open")}),d.find(".nx-group-field-add").on("click",function(e){e.preventDefault();var t=d.attr("id"),i=d.data("name"),n=(d.find(".nx-group-fields-wrapper"),d.find(".nx-group-field")),a=(d.find(".nx-group-field:first"),d.find(".nx-group-field:last")),o=c(d.find(".nx-group-template").html()),r=parseInt(a.data("id"))+1;o.data("group-title");n.each(function(){c(this).removeClass("open")}),o.attr("data-id",r),o.addClass("open"),o.find("tr.nx-field[id*="+t+"]").each(function(){var e=i,t=c(this).attr("id").split("[1]")[1],n=e+"["+r+"]"+t,a=c(this).find("th label");c(this).find('[name*="'+e+'[1]"]').each(function(){var e=c(this).attr("name").split("[1]"),t=e[0],n=e[1],i=t+"["+r+"]"+n;c(this).attr("id",i).attr("name",i),a.attr("for",i)}),c(this).attr("id",n)}),o.insertBefore(c(this))})})},setDate:function(e){var t=new Date;e.find(".nx-group-field-timestamp").val(t.getTime())},groupToggle:function(e){var t=(e=c(e)).parents(".nx-group-field");t.hasClass("open")?t.removeClass("open"):t.addClass("open").siblings().removeClass("open")},removeGroup:function(e){var t=c(e).parents(".nx-group-field").data("id");c(e).parents('.nx-group-field[data-id="'+t+'"]').fadeOut({duration:300,complete:function(){c(this).remove()}})},cloneGroup:function(e){var t=c(e).parents(".nx-group-field").data("id"),n=c(e).parents('.nx-group-field[data-id="'+t+'"]'),i=c(n.clone()),a=c(e).parents(".nx-group-fields-wrapper").find(".nx-group-field:last"),o=n.parent(),r=c(a).data("id")+1;i.attr("data-id",r),i.insertAfter(n),d.resetFieldIds(o.find(".nx-group-field"))},resetFieldIds:function(e){var a=1;e.each(function(){var e=c(this),i=e.data("field-name"),t="nx-"+i,n=e.find(".nx-group-field-info").data("info").group_sub_fields;e.data("id",a),n.forEach(function(n){e.find('tr.nx-field[id="nx-'+n.field_name+'"]').find('[name*="'+n.field_name+'"]').each(function(){var e=c(this).attr("name"),t=e.split(n.field_name)[0];void 0===t&&(t=""),e=e.replace(e,t+i+"["+a+"]["+n.original_name+"]"),c(this).attr("name",e).attr("id",e)}),e.find('tr.nx-field[id="nx-'+n.field_name+'"]').attr("id",t+"["+a+"]["+n.original_name+"]")}),a++})},initMediaField:function(t){var e=(t=c(t)).parents(".nx-media-field-wrapper"),n=e.find(".nx-media-remove-button"),i=e.find(".nx-thumb-container"),a=e.find(".nx-media-id"),o=e.find(".nx-media-url"),r=wp.media({title:"Upload Photo",button:{text:"Use this photo"},multiple:!1});r.on("select",function(){var e=r.state().get("selection").first().toJSON();i.addClass("nx-has-thumb").append('<img src="'+e.url+'" alt="" style="max-width:100%;"/>'),a.val(e.id),o.val(e.url),t.addClass("hidden"),n.removeClass("hidden")}),r.open()},removeMedia:function(e){var t=(e=c(e)).parents(".nx-media-field-wrapper"),n=t.find(".nx-media-upload-button"),i=t.find(".nx-has-thumb"),a=t.find(".nx-media-id"),o=t.find(".nx-media-url");i.removeClass("nx-has-thumb").find("img").remove(),o.val(""),a.val(""),e.addClass("hidden"),n.removeClass("hidden")},shownPreview:function(e){"press_bar"===e?c("#nx-notification-preview").hide():(c("#nx-notification-preview").removeClass("nx-notification-preview-comments").removeClass("nx-notification-preview-conversions"),c("#nx-notification-preview").show().addClass("nx-notification-preview-"+e))},updatePreview:function(e){e.map(function(d,e){var s=d.event||"change";c(d.id).each(function(){c(this).on(s,function(){var e=c(this).val(),t="",n=".notificationx-inner";if(void 0!==d.selector&&(n=d.selector),void 0!==d.unit&&(t=d.unit),"click"==s&&"border"==d.field&&(window.itemshide=d.hide,c(this).is(":checked")?d.hide.forEach(function(e){var t=c(e.key).val();c(n).css(e.property,t)}):d.hide.forEach(function(e){"border-width"==e.property?c(n).css(e.property,"0px"):c(n).css(e.property,"")})),"nx_theme"==d.field){var i=c(this).find("input"),a=i.val(),o="nx-notification-"+i.data("prev_theme"),r="nx-notification-"+a;c(n).removeClass(o),c(n).addClass(r),i.data("prev_theme",a)}void 0!==d.property&&c(n).css(d.property,e+t),"image_shape"!=d.field&&"comment_image_shape"!=d.field||c(n).removeClass("nx-img-circle nx-img-rounded nx-img-square"),"image_position"!=d.field&&"comment_image_position"!=d.field||c(n).removeClass("nx-img-left nx-img-right"),"image_shape"!=d.field&&"image_position"!=d.field&&"comment_image_shape"!=d.field&&"comment_image_position"!=d.field||(c(n).addClass("nx-img-"+e),"image_position"!=d.field&&"comment_image_position"!=d.field||("left"==e?c(".notificationx-inner").removeClass("nx-flex-reverse"):c(".notificationx-inner").addClass("nx-flex-reverse")))})})})},optinAllowOrNot:function(e){var t=(e=c(e)).data("args"),n=e.parents(".nx-opt-in"),i=n.find(".nx-single-opt input"),a={};i.each(function(){var e=c(this)[0],t=e.id;c(e).is(":checked")?a[t]=!0:a[t]=!1}),a=Object.assign(a,t),c.ajax({type:"post",url:ajaxurl,data:{action:"nx_optin_check",fields:a},success:function(e){"true"!=e&&"false"!=e||n.slideToggle("500")}})},settingsTab:function(e){var t=(e=c(e)).data("tab");e.addClass("active").siblings().removeClass("active"),c("#nx-"+t).addClass("active").siblings().removeClass("active")},submitSettings:function(e){var t=(e=c(e)).data("key"),n=e.data("nonce"),i=e.parent("#nx-settings-general-form"),a=c(i).serializeArray();c.ajax({type:"POST",url:ajaxurl,data:{action:"nx_general_settings",key:t,nonce:n,form_data:a},success:function(e){"success"===e?swal({title:"Settings Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]}):swal({title:"Settings Not Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"]})}})},createTitle:function(e){c("body").on("change",e,function(e){return[c(this).val(),e.currentTarget.selectedOptions[0].innerText,(new Date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]})}};c(document).ready(function(){var n=c(".nx-metatab-menu, .nx-builder-tab-menu");n.on("click","li",function(){var e=c(this).data("tab"),t=c(this).data("tabid")-1;c("#nx_builder_current_tab").val(e),n.find("li").each(function(e){e<t?c(this).addClass("nx-complete"):c(this).removeClass("nx-complete")}),c(this).addClass("active").siblings().removeClass("active"),c("#nx-"+e).addClass("active").siblings().removeClass("active")}),d.init()}),c(window).load(function(){c("body").on("change","#nx_meta_display_type",function(){var e=c(this).val();d.shownPreview(e),"conversions"==e&&c("#nx_meta_conversion_from").trigger("change")}),c("body").on("change","#nx_meta_display_type.nx-select",function(e){var t=c(this).val(),n=e.currentTarget.selectedOptions[0].innerText,i=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});"conversions"===t?(c("body").on("change","#nx_meta_conversion_from.nx-select",function(e){c(this).val();var t=e.currentTarget.selectedOptions[0].innerText;c(".finalize_notificationx_name").text("NotificationX - "+t+" - "+i)}),c("#nx_meta_conversion_from.nx-select").trigger("change")):c(".finalize_notificationx_name").text("NotificationX - "+n+" - "+i)}),c("#nx_meta_display_type").trigger("change");d.updatePreview([{id:["#nx_meta_bg_color","#nx_meta_comment_bg_color"],field:"bg_color",property:"background-color"},{id:["#nx_meta_text_color","#nx_meta_comment_text_color"],field:"text_color",property:"color"},{id:["#nx_meta_border","#nx_meta_comment_border"],field:"border",event:"click",selector:".notificationx-inner",hide:[{key:"#nx_meta_border_size",property:"border-width"},{key:"#nx_meta_border_style",property:"border-style"},{key:"#nx_meta_border_color",property:"border-color"},{key:"#nx_meta_comment_border_size",property:"border-width"},{key:"#nx_meta_comment_border_style",property:"border-style"},{key:"#nx_meta_comment_border_color",property:"border-color"}]},{id:["#nx_meta_border_size","#nx_meta_comment_border_size"],field:"border_size",event:"keyup",property:"border-width",selector:".notificationx-inner",unit:"px"},{id:["#nx_meta_border_style","#nx_meta_comment_border_style"],field:"border_style",property:"border-style",selector:".notificationx-inner"},{id:["#nx_meta_border_color","#nx_meta_comment_border_color"],field:"border_color",property:"border-color",selector:".notificationx-inner"},{id:["#nx_meta_image_shape","#nx_meta_comment_image_shape"],field:"image_shape",selector:".nx-preview-image > img"},{id:["#nx_meta_image_position","#nx_meta_comment_image_position"],field:"image_position",selector:".notificationx-inner"},{id:["#nx_meta_first_font_size","#nx_meta_comment_first_font_size"],field:"first_font_size",selector:".nx-first-row",property:"font-size",event:"keyup",unit:"px"},{id:["#nx_meta_second_font_size","#nx_meta_comment_second_font_size"],field:"second_font_size",selector:".nx-second-row",property:"font-size",event:"keyup",unit:"px"},{id:["#nx_meta_third_font_size","#nx_meta_comment_third_font_size"],field:"third_font_size",selector:".nx-third-row",property:"font-size",event:"keyup",unit:"px"},{id:["#nx-meta-theme","#nx-meta-comment_theme"],field:"nx_theme",event:"change",selector:".notificationx-inner"}]);var s=[{id:["#nx_meta_image_shape","#nx_meta_bg_color","#nx_meta_text_color","#nx_meta_image_position"],event:"change",type:"conversions"},{id:["#nx_meta_border_color","#nx_meta_border_style"],event:"change",type:"conversions",dependency:"#nx_meta_border"},{id:["#nx_meta_border_size"],event:"keyup",type:"conversions",dependency:"#nx_meta_border"},{id:["#nx_meta_first_font_size","#nx_meta_second_font_size","#nx_meta_third_font_size"],event:"keyup",type:"conversions"},{id:["#nx_meta_comment_image_shape","#nx_meta_comment_bg_color","#nx_meta_comment_text_color","#nx_meta_comment_image_position"],event:"change",type:"comments"},{id:["#nx_meta_comment_border_color","#nx_meta_comment_border_style"],event:"change",type:"comments",dependency:"#nx_meta_comment_border"},{id:["#nx_meta_comment_border_size"],event:"keyup",type:"comments",dependency:"#nx_meta_comment_border"},{id:["#nx_meta_comment_first_font_size","#nx_meta_comment_second_font_size","#nx_meta_comment_third_font_size"],event:"keyup",type:"comments"}];c(".nx-meta-adv_checkbox").each(function(){var d=c(this);d.on("click","label",function(e){var t,n,i=s.length;if(c(d).find("input").is(":checked"))return c(".notificationx-inner").removeAttr("style"),c(".notificationx-inner").removeClass("nx-img-left nx-img-right nx-flex-reverse"),void c(".notificationx-image > img").removeClass();for(t=0;t<i;t++){var a=s[t],o=a.id.length;for(n=0;n<o;n++){var r=c(a.id[n]);if(c("#nx_meta_display_type").val()===a.type){if(void 0!==a.dependency){if(0<c(a.dependency+":checked").length)return void c(r).trigger(a.event);continue}c(r).trigger(a.event)}}}})})})}(jQuery);